{"version":3,"file":"ui-library.min.js","sources":["../src/template-loader.js","../src/components/toast/toast.js","../src/components/theme-toggle/theme-toggle.js","../src/components/icons/lucide-icon.js","../src/components/forms.js","../src/index.js"],"sourcesContent":["/**\n * Template processing utilities for web components\n */\n\n/**\n * Creates a document fragment from HTML string\n *\n * @param {string} html - HTML string to convert to DocumentFragment\n * @returns {DocumentFragment} Document fragment containing the parsed HTML\n */\nexport function htmlToFragment(html) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = html.trim();\n  return template.content.cloneNode(true);\n}\n\n/**\n * Loads component template from an HTML file\n * This works with rollup-plugin-html which converts HTML imports to strings\n *\n * @param {string} htmlString - Imported HTML string\n * @param {ShadowRoot} shadowRoot - The shadow root to append the template to\n * @returns {DocumentFragment} Document fragment of the parsed template\n */\nexport function loadTemplate(htmlString, shadowRoot) {\n  const fragment = htmlToFragment(htmlString);\n  shadowRoot.appendChild(fragment);\n  return fragment;\n}\n\n/**\n * Combines HTML template with inline styles\n *\n * @param {string} htmlString - Imported HTML string\n * @param {string} cssString - Imported CSS string\n * @returns {string} Combined HTML with inline <style> element\n */\nexport function combineTemplateWithStyles(htmlString, cssString) {\n  // If the HTML already has a <style> tag, append to it\n  if (htmlString.includes(\"<style>\")) {\n    return htmlString.replace(\"<style>\", `<style>${cssString}`);\n  }\n\n  // Otherwise add the style tag at the beginning\n  return `<style>${cssString}</style>${htmlString}`;\n}\n\n/**\n * Applies styles to a shadow root using Constructable Stylesheets if supported\n *\n * @param {ShadowRoot} shadowRoot - The shadow root to apply styles to\n * @param {string} cssString - CSS string to apply\n * @param {CSSStyleSheet[]} documentSheets - Optional array of document stylesheets to inherit\n * @returns {boolean} True if styles were applied using Constructable Stylesheets\n */\nexport function applyStyles(shadowRoot, cssString, documentSheets = []) {\n  try {\n    // Check if Constructable Stylesheets are supported\n    if (\n      !(\"CSSStyleSheet\" in window) ||\n      !(\"replaceSync\" in CSSStyleSheet.prototype)\n    ) {\n      return false;\n    }\n\n    // Create component-specific stylesheet\n    const componentSheet = new CSSStyleSheet();\n    componentSheet.replaceSync(cssString);\n\n    // Apply document stylesheets + component stylesheet\n    if (documentSheets.length > 0) {\n      shadowRoot.adoptedStyleSheets = [...documentSheets, componentSheet];\n    } else {\n      // Just use component styles if no document stylesheets provided\n      shadowRoot.adoptedStyleSheets = [componentSheet];\n    }\n\n    return true;\n  } catch (error) {\n    console.error(\n      \"Error applying styles with Constructable Stylesheets:\",\n      error,\n    );\n    return false;\n  }\n}\n","import { applyStyles, loadTemplate } from \"../../template-loader.js\";\nimport toastTemplate from \"./toast.html\";\nimport toastStyles from \"./toast.css\";\n\n/**\n * Toast notification component\n * @element toast-element\n * @attr {string} type - Toast type: 'success', 'error', 'info', 'warning'\n * @attr {string} message - Toast message text\n * @attr {number} duration - Display duration in milliseconds\n * @attr {boolean} auto-hide - Whether to automatically hide the toast\n */\nexport class ToastElement extends HTMLElement {\n  constructor() {\n    super();\n\n    // Create shadow DOM\n    this.attachShadow({ mode: \"open\" });\n\n    // Apply styles\n    applyStyles(this.shadowRoot, toastStyles, document.adoptedStyleSheets);\n    loadTemplate(toastTemplate, this.shadowRoot);\n\n    // Initialize properties\n    this._duration = 3000;\n    this._autoHide = true;\n    this._timerId = null;\n    this._type = \"toast-info\";\n\n    // Get required elements\n    this.messageElement = this.shadowRoot.querySelector(\".message\");\n    this.closeButton = this.shadowRoot.querySelector(\".close-btn\");\n    this.iconElement = this.shadowRoot.querySelector(\".icon-type\");\n\n    // Add event listener for close button\n    this.closeButton.addEventListener(\"click\", () => this.hide());\n  }\n\n  /**\n   * Web component lifecycle: When attributes change\n   */\n  static get observedAttributes() {\n    return [\"type\", \"message\", \"duration\", \"auto-hide\"];\n  }\n\n  /**\n   * Web component lifecycle: Component added to DOM\n   */\n  connectedCallback() {\n    // Initialize from attributes if present\n    if (this.hasAttribute(\"message\")) {\n      this.messageElement.textContent = this.getAttribute(\"message\");\n    }\n\n    if (this.hasAttribute(\"type\")) {\n      this.type = this.getAttribute(\"type\");\n    } else {\n      // Apply default type\n      this.classList.add(this._type);\n      // Set default icon\n      this._updateIcon(this._type);\n    }\n\n    if (this.hasAttribute(\"duration\")) {\n      this._duration = parseInt(this.getAttribute(\"duration\"), 10);\n    }\n\n    if (this.hasAttribute(\"auto-hide\")) {\n      this._autoHide = this.getAttribute(\"auto-hide\") !== \"false\";\n    }\n  }\n\n  /**\n   * Web component lifecycle: Attribute changed\n   */\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"message\" && this.messageElement) {\n      this.messageElement.textContent = newValue;\n    } else if (name === \"type\" && newValue) {\n      this.type = newValue;\n    } else if (name === \"duration\" && newValue) {\n      this._duration = parseInt(newValue, 10);\n    } else if (name === \"auto-hide\") {\n      this._autoHide = newValue !== \"false\";\n    }\n  }\n\n  /**\n   * Update the icon based on toast type\n   * @private\n   */\n  _updateIcon(type) {\n    if (this.iconElement) {\n      // Map toast type to icon name\n      const iconName = type.replace(\"toast-\", \"\") || \"info\";\n      this.iconElement.setAttribute(\"name\", iconName);\n      this.iconElement.setAttribute(\"variant\", iconName);\n    }\n  }\n\n  /**\n   * Type getter\n   */\n  get type() {\n    return this._type.replace(\"toast-\", \"\");\n  }\n\n  /**\n   * Type setter\n   */\n  set type(value) {\n    if (this._type) {\n      this.classList.remove(this._type);\n    }\n\n    this._type = `toast-${value}`;\n    this.classList.add(this._type);\n\n    // Update the icon when type changes\n    this._updateIcon(value);\n  }\n\n  /**\n   * Message getter\n   */\n  get message() {\n    return this.messageElement ? this.messageElement.textContent : \"\";\n  }\n\n  /**\n   * Message setter\n   */\n  set message(value) {\n    if (this.messageElement) {\n      this.messageElement.textContent = value;\n    }\n  }\n\n  /**\n   * Duration getter\n   */\n  get duration() {\n    return this._duration;\n  }\n\n  /**\n   * Duration setter\n   */\n  set duration(value) {\n    this._duration = value;\n  }\n\n  /**\n   * Auto-hide getter\n   */\n  get autoHide() {\n    return this._autoHide;\n  }\n\n  /**\n   * Auto-hide setter\n   */\n  set autoHide(value) {\n    this._autoHide = value;\n  }\n\n  /**\n   * Show the toast notification\n   * @returns {ToastElement} This instance for chaining\n   */\n  show() {\n    if (this._visible) return this;\n\n    this._visible = true;\n    this.classList.add(\"visible\");\n\n    // Dispatch shown event\n    this.dispatchEvent(new CustomEvent(\"toast:shown\"));\n\n    // Reposition all toasts\n    this._repositionAllToasts();\n\n    if (this._autoHide && this._duration > 0) {\n      this._timerId = setTimeout(() => {\n        this.hide();\n      }, this._duration);\n    }\n\n    return this;\n  }\n\n  /**\n   * Hide the toast notification\n   * @returns {ToastElement} This instance for chaining\n   */\n  hide() {\n    if (!this._visible) return this;\n\n    this._visible = false;\n    this.classList.remove(\"visible\");\n\n    if (this._timerId) {\n      clearTimeout(this._timerId);\n      this._timerId = null;\n    }\n\n    // Add a small delay to allow for animation, matching GraphQLToast\n    setTimeout(() => {\n      // Dispatch hidden event\n      this.dispatchEvent(new CustomEvent(\"toast:hidden\"));\n\n      // If this is from auto-hide, remove the element from DOM\n      if (this.parentNode) {\n        this.parentNode.removeChild(this);\n      }\n\n      // Reposition remaining toasts\n      this._repositionAllToasts();\n    }, 300); // Match this delay with CSS transition time\n\n    return this;\n  }\n\n  /**\n   * Reposition all toasts to stack properly\n   * @private\n   */\n  _repositionAllToasts() {\n    const toasts = document.querySelectorAll(\"toast-element\");\n    const spaceBetweenToasts = 10; // Margin between toasts in pixels\n    let cumulativeHeight = 0;\n\n    // Convert NodeList to Array and reverse to start from the bottom\n    // This way we process toasts from bottom to top\n    Array.from(toasts)\n      .reverse()\n      .forEach((toast) => {\n        // Position this toast above the previous ones\n        toast.style.bottom = `${20 + cumulativeHeight}px`;\n        toast.style.right = \"20px\";\n\n        // Add this toast's height to the cumulative height\n        cumulativeHeight += toast.scrollHeight + spaceBetweenToasts;\n      });\n  }\n}\n\n// Helper function\nexport function showToast(options = {}) {\n  const {\n    message = \"\",\n    type = \"info\",\n    duration = 3000,\n    autoHide = true,\n  } = options;\n\n  const toast = document.createElement(\"toast-element\");\n  toast.message = message;\n  toast.type = type;\n  toast.duration = duration;\n  toast.autoHide = autoHide;\n\n  document.body.appendChild(toast);\n  toast.show();\n\n  toast.addEventListener(\"toast:hidden\", () => {\n    setTimeout(() => {\n      if (document.body.contains(toast)) {\n        document.body.removeChild(toast);\n      }\n    }, 200);\n  });\n\n  return toast;\n}\n\n// Export for CommonJS\nif (typeof module !== \"undefined\" && module.exports) {\n  module.exports = { ToastElement, showToast };\n}\n\n// Export for global usage\nif (typeof window !== \"undefined\") {\n  window.ToastElement = ToastElement;\n  window.showToast = showToast;\n}\n","import { applyStyles, loadTemplate } from \"../../template-loader.js\";\nimport toggleTemplate from \"./theme-toggle.html\";\nimport toggleStyles from \"./theme-toggle.css\";\n\nexport class ThemeToggle extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: \"open\" });\n    // Apply styles\n    applyStyles(this.shadowRoot, toggleStyles, document.adoptedStyleSheets);\n    loadTemplate(toggleTemplate, this.shadowRoot);\n    this.initializeTheme();\n  }\n\n  initializeTheme() {\n    // Check localStorage first\n    const savedTheme = localStorage.getItem(\"theme\");\n\n    if (savedTheme) {\n      document.documentElement.setAttribute(\"data-theme\", savedTheme);\n    } else {\n      // If no saved preference, check system preference\n      const prefersDark = window.matchMedia(\n        \"(prefers-color-scheme: dark)\",\n      ).matches;\n      document.documentElement.setAttribute(\n        \"data-theme\",\n        prefersDark ? \"dark\" : \"light\",\n      );\n      localStorage.setItem(\"theme\", prefersDark ? \"dark\" : \"light\");\n    }\n\n    // Listen for system theme changes\n    window\n      .matchMedia(\"(prefers-color-scheme: dark)\")\n      .addEventListener(\"change\", (e) => {\n        if (!localStorage.getItem(\"theme\")) {\n          const newTheme = e.matches ? \"dark\" : \"light\";\n          document.documentElement.setAttribute(\"data-theme\", newTheme);\n        }\n      });\n  }\n\n  setupListeners() {\n    const toggle = this.shadowRoot.querySelector(\".toggle\");\n    toggle.addEventListener(\"click\", () => {\n      const isDark =\n        document.documentElement.getAttribute(\"data-theme\") === \"dark\";\n      document.documentElement.setAttribute(\n        \"data-theme\",\n        isDark ? \"light\" : \"dark\",\n      );\n\n      // Optionally save preference\n      localStorage.setItem(\"theme\", isDark ? \"light\" : \"dark\");\n    });\n  }\n\n  connectedCallback() {\n    this.setupListeners();\n  }\n}\n","import { applyStyles, loadTemplate } from \"../../template-loader.js\";\nimport iconTemplate from \"./lucide-icon.html\";\nimport iconStyles from \"./lucide-icon.css\";\n\n/**\n * Available icons these are copied from Lucide https://lucide.dev/icons/\n *\n * To add a new one just pick a name copy the contents of the svg here. Only include the\n * contents of the svg and remove the <svg *></svg> tags as that is added by the component.\n */\nconst icons = {\n  menu: '<line x1=\"3\" y1=\"12\" x2=\"21\" y2=\"12\"></line><line x1=\"3\" y1=\"6\" x2=\"21\" y2=\"6\"></line><line x1=\"3\" y1=\"18\" x2=\"21\" y2=\"18\"></line>',\n  home: '<path d=\"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\"></path><polyline points=\"9 22 9 12 15 12 15 22\"></polyline>',\n  settings:\n    '<path d=\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"/>',\n  moon: '<path d=\"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z\"/>',\n  sun: '<circle cx=\"12\" cy=\"12\" r=\"4\"/><path d=\"M12 2v2\"/><path d=\"M12 20v2\"/><path d=\"m4.93 4.93 1.41 1.41\"/><path d=\"m17.66 17.66 1.41 1.41\"/><path d=\"M2 12h2\"/><path d=\"M20 12h2\"/><path d=\"m6.34 17.66-1.41 1.41\"/><path d=\"m19.07 4.93-1.41 1.41\"/>',\n  // Add toast notification icons\n  success:\n    '<path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\"></path><polyline points=\"22 4 12 14.01 9 11.01\"></polyline>',\n  info: '<circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line>',\n  warning:\n    '<path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"></path><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"></line><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"></line>',\n  error:\n    '<circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line>',\n  x: '<line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>',\n};\n\n/**\n * LucideIcon web component\n * @element lucide-icon\n * @attr {string} name - Icon name\n * @attr {string} size - Icon size: 'small', 'default', 'large'\n * @attr {string} variant - Icon variant: 'primary', 'success', 'error', 'info', 'warning', 'muted'\n * @attr {string} color - Custom icon color\n */\nexport class LucideIcon extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: \"open\" });\n\n    // Apply styles and load template\n    applyStyles(this.shadowRoot, iconStyles, document.adoptedStyleSheets);\n    loadTemplate(iconTemplate, this.shadowRoot);\n\n    // Get the SVG element\n    this.svgElement = this.shadowRoot.querySelector(\"svg\");\n  }\n\n  static get observedAttributes() {\n    return [\"name\", \"size\", \"variant\", \"color\"];\n  }\n\n  connectedCallback() {\n    this.render();\n  }\n\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (oldValue !== newValue) {\n      this.render();\n    }\n  }\n\n  render() {\n    const name = this.getAttribute(\"name\");\n    const color = this.getAttribute(\"color\");\n    const iconPath = icons[name] || \"\";\n\n    // Update SVG content with the selected icon\n    if (this.svgElement) {\n      this.svgElement.innerHTML = iconPath;\n\n      // Apply custom color if specified\n      if (color) {\n        this.svgElement.style.color = color;\n      } else {\n        this.svgElement.style.color = \"\";\n      }\n    }\n  }\n}\n","import { showToast } from \"./toast/toast\";\n\n// Form error handling with PicoCSS\nexport class FormErrorHandler {\n  /**\n   * Handles API error responses by adding error attributes to form elements\n   * @param {Object} errorResponse - The error response object from the API\n   */\n  static handleErrors(errorResponse) {\n    // Check if there are errors to process\n    if (!errorResponse || !errorResponse.errors) {\n      console.error(\"Invalid error response format\");\n      return;\n    }\n\n    // Reset any existing errors first\n    FormErrorHandler.clearErrors();\n\n    // Process each form's errors\n    Object.keys(errorResponse.errors).forEach((formKey) => {\n      const formErrors = errorResponse.errors[formKey];\n\n      // Process each error for this form\n      formErrors.forEach((error) => {\n        if (!error.field || !error.message) {\n          console.warn(\"Invalid error format:\", error);\n          return;\n        }\n\n        // Find the input element\n        const fieldName = error.field;\n        const inputElement = document.querySelector(`[name=\"${fieldName}\"]`);\n\n        if (!inputElement) {\n          console.warn(\n            `Input element with name \"${error.field}\" not found. Adding error to form.`,\n          );\n\n          // Find the form element\n          const formElement = document.querySelector(\n            `form[name=\"${formKey}\"], form#${formKey}, form[data-form-id=\"${formKey}\"]`,\n          );\n          if (!formElement) {\n            // If we can't find the form, look for a div with the form's ID\n            const formContainer = document.getElementById(formKey);\n            if (!formContainer) {\n              console.error(\n                `Neither form nor container for \"${formKey}\" found`,\n              );\n              return;\n            }\n\n            // Add the error to the form container\n            FormErrorHandler.addError(formContainer, error.message);\n            return;\n          }\n\n          // Add the error to the form\n          FormErrorHandler.addError(formElement, error.message);\n          return;\n        }\n\n        // Use parent element (which would be the form field container in PicoCSS)\n        const parentElement = inputElement.parentElement;\n        if (!parentElement) {\n          console.warn(\n            `Parent element for input \"${error.field}\" not found. Adding error directly.`,\n          );\n          FormErrorHandler.addError(inputElement, error.message);\n          return;\n        }\n\n        // Add error to the parent element\n        FormErrorHandler.addError(parentElement, error.message);\n      });\n    });\n  }\n\n  /**\n   * Adds an error message to an element using PicoCSS ARIA attributes\n   * @param {HTMLElement} element - The element to add the error to\n   * @param {string} message - The error message\n   */\n  static addError(element, message) {\n    // Find the input element within the container (if element is not the input itself)\n    const inputElement =\n      element.tagName === \"INPUT\"\n        ? element\n        : element.querySelector(\"input, select, textarea\");\n\n    if (inputElement) {\n      // Set ARIA attributes for PicoCSS\n      inputElement.setAttribute(\"aria-invalid\", \"true\");\n\n      // Generate a unique ID for the helper element if needed\n      const helperId = `${inputElement.name}-helper`;\n      inputElement.setAttribute(\"aria-describedby\", helperId);\n\n      // Look for existing small/helper element\n      let helperElement = document.getElementById(helperId);\n\n      // If no helper element exists, create one\n      if (!helperElement) {\n        helperElement = document.createElement(\"small\");\n        helperElement.id = helperId;\n\n        // Add the small element after the input\n        if (inputElement.nextElementSibling) {\n          inputElement.parentNode.insertBefore(\n            helperElement,\n            inputElement.nextElementSibling,\n          );\n        } else {\n          inputElement.parentNode.appendChild(helperElement);\n        }\n      }\n\n      // Store original message if this is the first error\n      if (!helperElement.dataset.originalText) {\n        helperElement.dataset.originalText = helperElement.textContent;\n      }\n\n      // Set the error message\n      helperElement.textContent = message;\n    } else {\n      // For form level errors, create a message at the top\n      const errorMsg = document.createElement(\"p\");\n      errorMsg.className = \"error-message\";\n      errorMsg.setAttribute(\"role\", \"alert\");\n      errorMsg.textContent = message;\n\n      // Add to the beginning of the form\n      element.prepend(errorMsg);\n    }\n  }\n\n  /**\n   * Clear all existing error messages and restore original helper text\n   */\n  static clearErrors() {\n    // Reset all invalid inputs\n    document.querySelectorAll('[aria-invalid=\"true\"]').forEach((input) => {\n      // Remove the attribute completely rather than setting to false\n      // This returns the input to its initial state rather than marking as explicitly valid\n      input.removeAttribute(\"aria-invalid\");\n\n      // Get the helper element\n      const helperId = input.getAttribute(\"aria-describedby\");\n      if (helperId) {\n        const helperElement = document.getElementById(helperId);\n        if (helperElement && helperElement.dataset.originalText) {\n          // Restore original helper text\n          helperElement.textContent = helperElement.dataset.originalText;\n          delete helperElement.dataset.originalText;\n        }\n      }\n    });\n\n    // Remove any form-level error messages\n    document.querySelectorAll(\".error-message\").forEach((errMsg) => {\n      errMsg.remove();\n    });\n  }\n}\n\n// Create a utility class for handling GraphQL responses\nexport class GraphQLToastHandler {\n  /**\n   * Creates and displays toast notifications for GraphQL errors or success messages\n   * @param {Object} response - The GraphQL response object with data, errors, and extensions properties\n   * @param {number} [duration=4000] - How long the toast should stay visible (ms)\n   * @returns {Object} - The data portion of the response\n   */\n  static handleResponse(response, duration = 4000) {\n    // Check if there are errors to display\n    if (response.errors && response.errors.length > 0) {\n      // Display each error as a separate toast\n      response.errors.forEach((error) => {\n        showToast({\n          type: \"error\",\n          message: error.message || \"An error occurred\",\n          duration,\n        });\n      });\n    } else if (response.extensions && response.extensions.successMessage) {\n      // Display success message if provided in extensions\n      showToast({\n        type: \"success\",\n        message: response.extensions.successMessage,\n        duration,\n      });\n    }\n\n    // Return the data part of the response\n    return response.data;\n  }\n\n  /**\n   * Add HTMX extension for GraphQL responses\n   */\n  static registerHtmxExtension() {\n    // Only add if HTMX is available\n    if (typeof htmx === \"undefined\") {\n      console.warn(\"HTMX not found, GraphQL extension not loaded\");\n      return;\n    }\n\n    // Register the HTMX extension\n    htmx.defineExtension(\"graphql-toast\", {\n      onEvent: function (name, evt) {\n        // Handle JSON responses for HTMX requests\n        if (name === \"htmx:configRequest\") {\n          evt.detail.headers[\"Accept\"] = \"application/json\";\n          // Add all the params to the request\n          const params = new URLSearchParams(document.location.search);\n          for (const [key, value] of params.entries()) {\n            evt.detail.parameters[key] = value;\n          }\n        }\n\n        if (name === \"htmx:beforeRequest\") {\n          FormErrorHandler.clearErrors();\n        }\n\n        if (name === \"htmx:beforeSwap\") {\n          const xhr = evt.detail.xhr;\n\n          // Check if this is a JSON response\n          if (\n            xhr.getResponseHeader(\"Content-Type\")?.includes(\"application/json\")\n          ) {\n            try {\n              // Parse JSON response\n              const response = JSON.parse(xhr.responseText);\n\n              // Check if this looks like a GraphQL response (has data or errors)\n              if (\n                response &&\n                (response.data !== undefined || response.errors)\n              ) {\n                // Handle the GraphQL response notifications\n                GraphQLToastHandler.handleResponse(response);\n\n                // Check if there's HTML in the extensions\n                if (response.extensions && response.extensions.html) {\n                  // Use the HTML from extensions for the swap\n                  evt.detail.serverResponse = response.extensions.html;\n                } else if (!response.data && response.errors) {\n                  // If there's an error but no HTML or data, prevent the swap\n                  evt.detail.shouldSwap = false;\n                  return true;\n                }\n\n                if (response.extensions && response.extensions.errors) {\n                  FormErrorHandler.handleErrors(response.extensions);\n                }\n              }\n            } catch (e) {\n              console.error(\"Error processing JSON response:\", e);\n            }\n          }\n        }\n      },\n    });\n  }\n}\n","import { ToastElement } from \"./components/toast/toast.js\";\nimport { ThemeToggle } from \"./components/theme-toggle/theme-toggle.js\";\nimport { LucideIcon } from \"./components/icons/lucide-icon.js\";\nimport { GraphQLToastHandler, FormErrorHandler } from \"./components/forms.js\";\n\n// The main initialization function\nasync function initialize() {\n  // prevent content flashing\n  document.body.style.opacity = 0;\n\n  try {\n    // 1. Load and apply Pico CSS\n    // const picoResponse = await fetch(\n    //   \"https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css\",\n    // );\n    // const picoCSS = await picoResponse.text();\n\n    // const picoStyleSheet = new CSSStyleSheet();\n    // picoStyleSheet.replaceSync(picoCSS);\n    // document.adoptedStyleSheets = [picoStyleSheet];\n\n    // 2. Add your custom styles\n    const customStyleSheet = new CSSStyleSheet();\n    customStyleSheet.replaceSync(`\n      :root {\n        --toast-border-radius: 8px;\n        /* More custom variables... */\n      }\n    `);\n\n    // 3. Apply stylesheets to document\n    document.adoptedStyleSheets = [customStyleSheet];\n\n    // 4. Register web components if not already registered\n    if (!customElements.get(\"toast-element\")) {\n      customElements.define(\"toast-element\", ToastElement);\n    }\n\n    if (!customElements.get(\"theme-toggle\")) {\n      customElements.define(\"theme-toggle\", ThemeToggle);\n    }\n\n    if (!customElements.get(\"lucide-icon\")) {\n      customElements.define(\"lucide-icon\", LucideIcon);\n    }\n\n    // 5. Register HTMX plugin if HTMX is available\n    if (window.htmx) {\n      GraphQLToastHandler.registerHtmxExtension();\n    }\n\n    // Show the document\n    document.body.style.opacity = 1;\n\n    return true;\n  } catch (error) {\n    console.error(\"UI Library initialization failed:\", error);\n    // Show the document\n    document.body.style.opacity = 1;\n    return false;\n  }\n}\n\n// Expose library API\nconst UILibrary = {\n  initialize,\n  ToastElement,\n  ThemeToggle,\n  GraphQLToastHandler,\n  FormErrorHandler,\n};\n\n// Auto-initialize when DOM is ready\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", initialize);\n} else {\n  initialize();\n}\n\n// Export for module usage\nexport default UILibrary;\n\n// Export for global usage\nwindow.UILibrary = UILibrary;\n"],"names":["loadTemplate","htmlString","shadowRoot","fragment","html","template","document","createElement","innerHTML","trim","content","cloneNode","htmlToFragment","appendChild","applyStyles","cssString","documentSheets","window","CSSStyleSheet","prototype","componentSheet","replaceSync","length","adoptedStyleSheets","error","console","ToastElement","HTMLElement","constructor","super","this","attachShadow","mode","_duration","_autoHide","_timerId","_type","messageElement","querySelector","closeButton","iconElement","addEventListener","hide","observedAttributes","connectedCallback","hasAttribute","textContent","getAttribute","type","classList","add","_updateIcon","parseInt","attributeChangedCallback","name","oldValue","newValue","iconName","replace","setAttribute","value","remove","message","duration","autoHide","show","_visible","dispatchEvent","CustomEvent","_repositionAllToasts","setTimeout","clearTimeout","parentNode","removeChild","toasts","querySelectorAll","cumulativeHeight","Array","from","reverse","forEach","toast","style","bottom","right","scrollHeight","showToast","options","body","contains","module","exports","ThemeToggle","initializeTheme","savedTheme","localStorage","getItem","documentElement","prefersDark","matchMedia","matches","setItem","e","newTheme","setupListeners","isDark","icons","menu","home","settings","moon","sun","success","info","warning","x","LucideIcon","svgElement","render","color","iconPath","FormErrorHandler","handleErrors","errorResponse","errors","clearErrors","Object","keys","formKey","field","warn","fieldName","inputElement","formElement","formContainer","getElementById","addError","parentElement","element","tagName","helperId","helperElement","id","nextElementSibling","insertBefore","dataset","originalText","errorMsg","className","prepend","input","removeAttribute","errMsg","GraphQLToastHandler","handleResponse","response","extensions","successMessage","data","registerHtmxExtension","htmx","defineExtension","onEvent","evt","detail","headers","params","URLSearchParams","location","search","key","entries","parameters","xhr","getResponseHeader","includes","JSON","parse","responseText","undefined","serverResponse","shouldSwap","async","initialize","opacity","customStyleSheet","customElements","get","define","UILibrary","readyState"],"mappings":"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"}