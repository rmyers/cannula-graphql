{"version":3,"file":"ui-library.min.js","sources":["../src/template-loader.js","../src/components/toast/toast.js","../src/components/theme-toggle/theme-toggle.js","../src/components/forms.js","../src/index.js"],"sourcesContent":["/**\n * Template processing utilities for web components\n */\n\n/**\n * Creates a document fragment from HTML string\n *\n * @param {string} html - HTML string to convert to DocumentFragment\n * @returns {DocumentFragment} Document fragment containing the parsed HTML\n */\nexport function htmlToFragment(html) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = html.trim();\n  return template.content.cloneNode(true);\n}\n\n/**\n * Loads component template from an HTML file\n * This works with rollup-plugin-html which converts HTML imports to strings\n *\n * @param {string} htmlString - Imported HTML string\n * @param {ShadowRoot} shadowRoot - The shadow root to append the template to\n * @returns {DocumentFragment} Document fragment of the parsed template\n */\nexport function loadTemplate(htmlString, shadowRoot) {\n  const fragment = htmlToFragment(htmlString);\n  shadowRoot.appendChild(fragment);\n  return fragment;\n}\n\n/**\n * Combines HTML template with inline styles\n *\n * @param {string} htmlString - Imported HTML string\n * @param {string} cssString - Imported CSS string\n * @returns {string} Combined HTML with inline <style> element\n */\nexport function combineTemplateWithStyles(htmlString, cssString) {\n  // If the HTML already has a <style> tag, append to it\n  if (htmlString.includes(\"<style>\")) {\n    return htmlString.replace(\"<style>\", `<style>${cssString}`);\n  }\n\n  // Otherwise add the style tag at the beginning\n  return `<style>${cssString}</style>${htmlString}`;\n}\n\n/**\n * Applies styles to a shadow root using Constructable Stylesheets if supported\n *\n * @param {ShadowRoot} shadowRoot - The shadow root to apply styles to\n * @param {string} cssString - CSS string to apply\n * @param {CSSStyleSheet[]} documentSheets - Optional array of document stylesheets to inherit\n * @returns {boolean} True if styles were applied using Constructable Stylesheets\n */\nexport function applyStyles(shadowRoot, cssString, documentSheets = []) {\n  try {\n    // Check if Constructable Stylesheets are supported\n    if (\n      !(\"CSSStyleSheet\" in window) ||\n      !(\"replaceSync\" in CSSStyleSheet.prototype)\n    ) {\n      return false;\n    }\n\n    // Create component-specific stylesheet\n    const componentSheet = new CSSStyleSheet();\n    componentSheet.replaceSync(cssString);\n\n    // Apply document stylesheets + component stylesheet\n    if (documentSheets.length > 0) {\n      shadowRoot.adoptedStyleSheets = [...documentSheets, componentSheet];\n    } else {\n      // Just use component styles if no document stylesheets provided\n      shadowRoot.adoptedStyleSheets = [componentSheet];\n    }\n\n    return true;\n  } catch (error) {\n    console.error(\n      \"Error applying styles with Constructable Stylesheets:\",\n      error,\n    );\n    return false;\n  }\n}\n","import { applyStyles, loadTemplate } from \"../../template-loader.js\";\nimport toastTemplate from \"./toast.html\";\nimport toastStyles from \"./toast.css\";\n\n/**\n * Toast notification component\n * @element toast-element\n * @attr {string} type - Toast type: 'success', 'error', 'info', 'warning'\n * @attr {string} message - Toast message text\n * @attr {number} duration - Display duration in milliseconds\n * @attr {boolean} auto-hide - Whether to automatically hide the toast\n */\nexport class ToastElement extends HTMLElement {\n  constructor() {\n    super();\n\n    // Create shadow DOM\n    this.attachShadow({ mode: \"open\" });\n\n    // Apply styles\n    applyStyles(this.shadowRoot, toastStyles, document.adoptedStyleSheets);\n    loadTemplate(toastTemplate, this.shadowRoot);\n\n    // Initialize properties\n    this._duration = 3000;\n    this._autoHide = true;\n    this._timerId = null;\n    this._type = \"info\";\n\n    // Get required elements\n    this.messageElement = this.shadowRoot.querySelector(\".message\");\n    this.closeButton = this.shadowRoot.querySelector(\".close-btn\");\n\n    // Add event listener for close button\n    this.closeButton.addEventListener(\"click\", () => this.hide());\n  }\n\n  /**\n   * Web component lifecycle: When attributes change\n   */\n  static get observedAttributes() {\n    return [\"type\", \"message\", \"duration\", \"auto-hide\"];\n  }\n\n  /**\n   * Web component lifecycle: Component added to DOM\n   */\n  connectedCallback() {\n    // Initialize from attributes if present\n    if (this.hasAttribute(\"message\")) {\n      this.messageElement.textContent = this.getAttribute(\"message\");\n    }\n\n    if (this.hasAttribute(\"type\")) {\n      this.type = this.getAttribute(\"type\");\n    } else {\n      // Apply default type\n      this.classList.add(this._type);\n    }\n\n    if (this.hasAttribute(\"duration\")) {\n      this._duration = parseInt(this.getAttribute(\"duration\"), 10);\n    }\n\n    if (this.hasAttribute(\"auto-hide\")) {\n      this._autoHide = this.getAttribute(\"auto-hide\") !== \"false\";\n    }\n  }\n\n  /**\n   * Web component lifecycle: Attribute changed\n   */\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (name === \"message\" && this.messageElement) {\n      this.messageElement.textContent = newValue;\n    } else if (name === \"type\" && newValue) {\n      this.type = newValue;\n    } else if (name === \"duration\" && newValue) {\n      this._duration = parseInt(newValue, 10);\n    } else if (name === \"auto-hide\") {\n      this._autoHide = newValue !== \"false\";\n    }\n  }\n\n  /**\n   * Type getter\n   */\n  get type() {\n    return this._type;\n  }\n\n  /**\n   * Type setter\n   */\n  set type(value) {\n    if (this._type) {\n      this.classList.remove(this._type);\n    }\n\n    this._type = value;\n    this.classList.add(value);\n  }\n\n  /**\n   * Message getter\n   */\n  get message() {\n    return this.messageElement ? this.messageElement.textContent : \"\";\n  }\n\n  /**\n   * Message setter\n   */\n  set message(value) {\n    if (this.messageElement) {\n      this.messageElement.textContent = value;\n    }\n  }\n\n  /**\n   * Duration getter\n   */\n  get duration() {\n    return this._duration;\n  }\n\n  /**\n   * Duration setter\n   */\n  set duration(value) {\n    this._duration = value;\n  }\n\n  /**\n   * Auto-hide getter\n   */\n  get autoHide() {\n    return this._autoHide;\n  }\n\n  /**\n   * Auto-hide setter\n   */\n  set autoHide(value) {\n    this._autoHide = value;\n  }\n\n  /**\n   * Show the toast notification\n   * @returns {ToastElement} This instance for chaining\n   */\n  show() {\n    if (this._timerId) {\n      clearTimeout(this._timerId);\n      this._timerId = null;\n    }\n\n    this.classList.add(\"visible\");\n\n    if (this._autoHide) {\n      this._timerId = setTimeout(() => {\n        this.hide();\n      }, this._duration);\n    }\n\n    return this;\n  }\n\n  /**\n   * Hide the toast notification\n   * @returns {ToastElement} This instance for chaining\n   */\n  hide() {\n    this.classList.remove(\"visible\");\n\n    if (this._timerId) {\n      clearTimeout(this._timerId);\n      this._timerId = null;\n    }\n\n    this.dispatchEvent(new CustomEvent(\"toast-hidden\"));\n\n    return this;\n  }\n}\n\n// Helper function\nexport function showToast(options = {}) {\n  const {\n    message = \"\",\n    type = \"info\",\n    duration = 3000,\n    autoHide = true,\n  } = options;\n\n  const toast = document.createElement(\"toast-element\");\n  toast.message = message;\n  toast.type = type;\n  toast.duration = duration;\n  toast.autoHide = autoHide;\n\n  document.body.appendChild(toast);\n  toast.show();\n\n  toast.addEventListener(\"toast-hidden\", () => {\n    setTimeout(() => {\n      if (document.body.contains(toast)) {\n        document.body.removeChild(toast);\n      }\n    }, 200);\n  });\n\n  return toast;\n}\n\n// Export for CommonJS\nif (typeof module !== \"undefined\" && module.exports) {\n  module.exports = { ToastElement, showToast };\n}\n\n// Export for global usage\nif (typeof window !== \"undefined\") {\n  window.ToastElement = ToastElement;\n  window.showToast = showToast;\n}\n","import { applyStyles, loadTemplate } from \"../../template-loader.js\";\nimport toggleTemplate from \"./theme-toggle.html\";\nimport toggleStyles from \"./theme-toggle.css\";\n\nexport class ThemeToggle extends HTMLElement {\n  constructor() {\n    super();\n    this.attachShadow({ mode: \"open\" });\n    // Apply styles\n    applyStyles(this.shadowRoot, toggleStyles, document.adoptedStyleSheets);\n    loadTemplate(toggleTemplate, this.shadowRoot);\n    this.initializeTheme();\n  }\n\n  initializeTheme() {\n    // Check localStorage first\n    const savedTheme = localStorage.getItem(\"theme\");\n\n    if (savedTheme) {\n      document.documentElement.setAttribute(\"data-theme\", savedTheme);\n    } else {\n      // If no saved preference, check system preference\n      const prefersDark = window.matchMedia(\n        \"(prefers-color-scheme: dark)\",\n      ).matches;\n      document.documentElement.setAttribute(\n        \"data-theme\",\n        prefersDark ? \"dark\" : \"light\",\n      );\n      localStorage.setItem(\"theme\", prefersDark ? \"dark\" : \"light\");\n    }\n\n    // Listen for system theme changes\n    window\n      .matchMedia(\"(prefers-color-scheme: dark)\")\n      .addEventListener(\"change\", (e) => {\n        if (!localStorage.getItem(\"theme\")) {\n          const newTheme = e.matches ? \"dark\" : \"light\";\n          document.documentElement.setAttribute(\"data-theme\", newTheme);\n        }\n      });\n  }\n\n  setupListeners() {\n    const toggle = this.shadowRoot.querySelector(\".toggle\");\n    toggle.addEventListener(\"click\", () => {\n      const isDark =\n        document.documentElement.getAttribute(\"data-theme\") === \"dark\";\n      document.documentElement.setAttribute(\n        \"data-theme\",\n        isDark ? \"light\" : \"dark\",\n      );\n\n      // Optionally save preference\n      localStorage.setItem(\"theme\", isDark ? \"light\" : \"dark\");\n    });\n  }\n\n  connectedCallback() {\n    this.setupListeners();\n  }\n}\n","// Form error handling with PicoCSS\nexport class FormErrorHandler {\n  /**\n   * Handles API error responses by adding error attributes to form elements\n   * @param {Object} errorResponse - The error response object from the API\n   */\n  static handleErrors(errorResponse) {\n    // Check if there are errors to process\n    if (!errorResponse || !errorResponse.errors) {\n      console.error(\"Invalid error response format\");\n      return;\n    }\n\n    // Reset any existing errors first\n    FormErrorHandler.clearErrors();\n\n    // Process each form's errors\n    Object.keys(errorResponse.errors).forEach((formKey) => {\n      const formErrors = errorResponse.errors[formKey];\n\n      // Process each error for this form\n      formErrors.forEach((error) => {\n        if (!error.field || !error.message) {\n          console.warn(\"Invalid error format:\", error);\n          return;\n        }\n\n        // Find the input element\n        const fieldName = error.field;\n        const inputElement = document.querySelector(`[name=\"${fieldName}\"]`);\n\n        if (!inputElement) {\n          console.warn(\n            `Input element with name \"${error.field}\" not found. Adding error to form.`,\n          );\n\n          // Find the form element\n          const formElement = document.querySelector(\n            `form[name=\"${formKey}\"], form#${formKey}, form[data-form-id=\"${formKey}\"]`,\n          );\n          if (!formElement) {\n            // If we can't find the form, look for a div with the form's ID\n            const formContainer = document.getElementById(formKey);\n            if (!formContainer) {\n              console.error(\n                `Neither form nor container for \"${formKey}\" found`,\n              );\n              return;\n            }\n\n            // Add the error to the form container\n            FormErrorHandler.addError(formContainer, error.message);\n            return;\n          }\n\n          // Add the error to the form\n          FormErrorHandler.addError(formElement, error.message);\n          return;\n        }\n\n        // Use parent element (which would be the form field container in PicoCSS)\n        const parentElement = inputElement.parentElement;\n        if (!parentElement) {\n          console.warn(\n            `Parent element for input \"${error.field}\" not found. Adding error directly.`,\n          );\n          FormErrorHandler.addError(inputElement, error.message);\n          return;\n        }\n\n        // Add error to the parent element\n        FormErrorHandler.addError(parentElement, error.message);\n      });\n    });\n  }\n\n  /**\n   * Adds an error message to an element using PicoCSS ARIA attributes\n   * @param {HTMLElement} element - The element to add the error to\n   * @param {string} message - The error message\n   */\n  static addError(element, message) {\n    // Find the input element within the container (if element is not the input itself)\n    const inputElement =\n      element.tagName === \"INPUT\"\n        ? element\n        : element.querySelector(\"input, select, textarea\");\n\n    if (inputElement) {\n      // Set ARIA attributes for PicoCSS\n      inputElement.setAttribute(\"aria-invalid\", \"true\");\n\n      // Generate a unique ID for the helper element if needed\n      const helperId = `${inputElement.name}-helper`;\n      inputElement.setAttribute(\"aria-describedby\", helperId);\n\n      // Look for existing small/helper element\n      let helperElement = document.getElementById(helperId);\n\n      // If no helper element exists, create one\n      if (!helperElement) {\n        helperElement = document.createElement(\"small\");\n        helperElement.id = helperId;\n\n        // Add the small element after the input\n        if (inputElement.nextElementSibling) {\n          inputElement.parentNode.insertBefore(\n            helperElement,\n            inputElement.nextElementSibling,\n          );\n        } else {\n          inputElement.parentNode.appendChild(helperElement);\n        }\n      }\n\n      // Store original message if this is the first error\n      if (!helperElement.dataset.originalText) {\n        helperElement.dataset.originalText = helperElement.textContent;\n      }\n\n      // Set the error message\n      helperElement.textContent = message;\n    } else {\n      // For form level errors, create a message at the top\n      const errorMsg = document.createElement(\"p\");\n      errorMsg.className = \"error-message\";\n      errorMsg.setAttribute(\"role\", \"alert\");\n      errorMsg.textContent = message;\n\n      // Add to the beginning of the form\n      element.prepend(errorMsg);\n    }\n  }\n\n  /**\n   * Clear all existing error messages and restore original helper text\n   */\n  static clearErrors() {\n    // Reset all invalid inputs\n    document.querySelectorAll('[aria-invalid=\"true\"]').forEach((input) => {\n      // Remove the attribute completely rather than setting to false\n      // This returns the input to its initial state rather than marking as explicitly valid\n      input.removeAttribute(\"aria-invalid\");\n\n      // Get the helper element\n      const helperId = input.getAttribute(\"aria-describedby\");\n      if (helperId) {\n        const helperElement = document.getElementById(helperId);\n        if (helperElement && helperElement.dataset.originalText) {\n          // Restore original helper text\n          helperElement.textContent = helperElement.dataset.originalText;\n          delete helperElement.dataset.originalText;\n        }\n      }\n    });\n\n    // Remove any form-level error messages\n    document.querySelectorAll(\".error-message\").forEach((errMsg) => {\n      errMsg.remove();\n    });\n  }\n}\n\n// Create a utility class for handling GraphQL responses\nexport class GraphQLToastHandler {\n  /**\n   * Creates and displays toast notifications for GraphQL errors or success messages\n   * @param {Object} response - The GraphQL response object with data, errors, and extensions properties\n   * @param {number} [duration=4000] - How long the toast should stay visible (ms)\n   * @returns {Object} - The data portion of the response\n   */\n  static handleResponse(response, duration = 4000) {\n    // Check if there are errors to display\n    if (response.errors && response.errors.length > 0) {\n      // Display each error as a separate toast\n      response.errors.forEach((error) => {\n        GraphQLToastHandler.create(\n          \"error\",\n          error.message || \"An error occurred\",\n          duration,\n        );\n      });\n    } else if (response.extensions && response.extensions.successMessage) {\n      // Display success message if provided in extensions\n      GraphQLToastHandler.create(\n        \"success\",\n        response.extensions.successMessage,\n        duration,\n      );\n    }\n\n    // Return the data part of the response\n    return response.data;\n  }\n\n  /**\n   * Creates and shows a toast notification\n   * @param {string} type - Toast type: 'success', 'error', or 'info'\n   * @param {string} message - Message to display\n   * @param {number} duration - How long to show the toast in ms\n   * @returns {HTMLElement} - The created toast element\n   */\n  static create(type, message, duration = 4000) {\n    const toast = document.createElement(\"graphql-toast\");\n    toast.setAttribute(\"type\", type);\n    toast.setAttribute(\"message\", message);\n    toast.setAttribute(\"duration\", duration.toString());\n    document.body.appendChild(toast);\n    return toast;\n  }\n\n  /**\n   * Add HTMX extension for GraphQL responses\n   */\n  static registerHtmxExtension() {\n    // Only add if HTMX is available\n    if (typeof htmx === \"undefined\") {\n      console.warn(\"HTMX not found, GraphQL extension not loaded\");\n      return;\n    }\n\n    // Register the HTMX extension\n    htmx.defineExtension(\"graphql-toast\", {\n      onEvent: function (name, evt) {\n        // Handle JSON responses for HTMX requests\n        if (name === \"htmx:configRequest\") {\n          evt.detail.headers[\"Accept\"] = \"application/json\";\n          // Add all the params to the request\n          const params = new URLSearchParams(document.location.search);\n          for (const [key, value] of params.entries()) {\n            evt.detail.parameters[key] = value;\n          }\n        }\n\n        if (name === \"htmx:beforeRequest\") {\n          FormErrorHandler.clearErrors();\n        }\n\n        if (name === \"htmx:beforeSwap\") {\n          const xhr = evt.detail.xhr;\n\n          // Check if this is a JSON response\n          if (\n            xhr.getResponseHeader(\"Content-Type\")?.includes(\"application/json\")\n          ) {\n            try {\n              // Parse JSON response\n              const response = JSON.parse(xhr.responseText);\n\n              // Check if this looks like a GraphQL response (has data or errors)\n              if (\n                response &&\n                (response.data !== undefined || response.errors)\n              ) {\n                // Handle the GraphQL response notifications\n                GraphQLToastHandler.handleResponse(response);\n\n                // Check if there's HTML in the extensions\n                if (response.extensions && response.extensions.html) {\n                  // Use the HTML from extensions for the swap\n                  evt.detail.serverResponse = response.extensions.html;\n                } else if (!response.data && response.errors) {\n                  // If there's an error but no HTML or data, prevent the swap\n                  evt.detail.shouldSwap = false;\n                  return true;\n                }\n\n                if (response.extensions && response.extensions.errors) {\n                  FormErrorHandler.handleErrors(response.extensions);\n                }\n              }\n            } catch (e) {\n              console.error(\"Error processing JSON response:\", e);\n            }\n          }\n        }\n      },\n    });\n  }\n}\n","import { ToastElement } from \"./components/toast/toast.js\";\nimport { ThemeToggle } from \"./components/theme-toggle/theme-toggle.js\";\nimport { GraphQLToastHandler, FormErrorHandler } from \"./components/forms.js\";\n\n// The main initialization function\nasync function initialize() {\n  try {\n    // 1. Load and apply Pico CSS\n    const picoResponse = await fetch(\n      \"https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css\",\n    );\n    const picoCSS = await picoResponse.text();\n\n    const picoStyleSheet = new CSSStyleSheet();\n    picoStyleSheet.replaceSync(picoCSS);\n    document.adoptedStyleSheets = [picoStyleSheet];\n\n    // 2. Add your custom styles\n    const customStyleSheet = new CSSStyleSheet();\n    customStyleSheet.replaceSync(`\n      :root {\n        --toast-border-radius: 8px;\n        /* More custom variables... */\n      }\n    `);\n\n    // 3. Apply stylesheets to document\n    document.adoptedStyleSheets = [picoStyleSheet, customStyleSheet];\n\n    // 4. Register web components if not already registered\n    if (!customElements.get(\"toast-element\")) {\n      customElements.define(\"toast-element\", ToastElement);\n    }\n\n    if (!customElements.get(\"theme-toggle\")) {\n      customElements.define(\"theme-toggle\", ThemeToggle);\n    }\n\n    // 5. Register HTMX plugin if HTMX is available\n    if (window.htmx) {\n      GraphQLToastHandler.registerHtmxExtension();\n    }\n\n    return true;\n  } catch (error) {\n    console.error(\"UI Library initialization failed:\", error);\n    return false;\n  }\n}\n\n// Expose library API\nconst UILibrary = {\n  initialize,\n  ToastElement,\n  ThemeToggle,\n  GraphQLToastHandler,\n  FormErrorHandler,\n};\n\n// Auto-initialize when DOM is ready\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", initialize);\n} else {\n  initialize();\n}\n\n// Export for module usage\nexport default UILibrary;\n\n// Export for global usage\nwindow.UILibrary = UILibrary;\n"],"names":["loadTemplate","htmlString","shadowRoot","fragment","html","template","document","createElement","innerHTML","trim","content","cloneNode","htmlToFragment","appendChild","applyStyles","cssString","documentSheets","window","CSSStyleSheet","prototype","componentSheet","replaceSync","length","adoptedStyleSheets","error","console","ToastElement","HTMLElement","constructor","super","this","attachShadow","mode","_duration","_autoHide","_timerId","_type","messageElement","querySelector","closeButton","addEventListener","hide","observedAttributes","connectedCallback","hasAttribute","textContent","getAttribute","type","classList","add","parseInt","attributeChangedCallback","name","oldValue","newValue","value","remove","message","duration","autoHide","show","clearTimeout","setTimeout","dispatchEvent","CustomEvent","showToast","options","toast","body","contains","removeChild","module","exports","ThemeToggle","initializeTheme","savedTheme","localStorage","getItem","documentElement","setAttribute","prefersDark","matchMedia","matches","setItem","e","newTheme","setupListeners","isDark","FormErrorHandler","handleErrors","errorResponse","errors","clearErrors","Object","keys","forEach","formKey","field","warn","fieldName","inputElement","formElement","formContainer","getElementById","addError","parentElement","element","tagName","helperId","helperElement","id","nextElementSibling","parentNode","insertBefore","dataset","originalText","errorMsg","className","prepend","querySelectorAll","input","removeAttribute","errMsg","GraphQLToastHandler","handleResponse","response","create","extensions","successMessage","data","toString","registerHtmxExtension","htmx","defineExtension","onEvent","evt","detail","headers","params","URLSearchParams","location","search","key","entries","parameters","xhr","getResponseHeader","includes","JSON","parse","responseText","undefined","serverResponse","shouldSwap","async","initialize","picoResponse","fetch","picoCSS","text","picoStyleSheet","customStyleSheet","customElements","get","define","UILibrary","readyState"],"mappings":"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"}